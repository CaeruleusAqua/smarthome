=================================
Release 1.7 - noch nicht released
=================================

Es gibt eine Menge neuer Features im Core von SmartHomeNG und den Plugins.

.. note::

    Diese Release Notes sind ein Arbeitsstand.

     - Berücksichtigt sind Commits im smarthome Repository bis incl. 21. Mär 2020
     - Berücksichtigt sind Commits im plugins Repository bis incl. 21. Mär 2020



Unterstützte Python Versionen
=============================

Die älteste offiziell unterstützte Python Version für SmartHomeNG Release 1.7 ist Python 3.5.
(Siehe auch *Hard- u. Software Anforderungen* im Abschnitt *Installation* zu unterstützten Python Versionen)

..
    Das bedeutet nicht unbedingt, dass SmartHomeNG ab Release 1.7 nicht mehr unter älteren Python Versionen läuft. Es
    bedeutet, dass SmartHomeNG nicht mehr mit älteren Python Versionen getestet wird und das gemeldete Fehler mit älteren
    Python Versionen nicht mehr zu Buxfixen führen.

    Es werden jedoch zunehmend Features eingesetzt, die erste ab Python 3.5 zur Verfügung stehen.


Absolute minimum Python Version
===============================

Die Minimum Python Version in der SmartHomeNG startet wurde auf v3.5 angehoben, da Python 3.4 im Jahr 2019 End-of-Life
(End of security fixes) gegangen ist. Bei einer Neuinstallation wird jedoch empfohlen auf einer der neueren Python
Versionen (3.6 oder 3.7) aufzusetzen.

.. important::

   Mit dem kommenden Release 1.8 werden die unterstützten Python Versionen (wie hier beschrieben) auf **Python 3.6, 3.7,
   3.8** angehoben. Python 3.6 hat eine Reihe sehr interessanter Features und Verbesserungen gebracht, die dann in
   SmartHomeNG genutzt werden können.

   Sollten solche neuen Features in den Core Einzug halten, wird die **Absolute minimum Python Version** auf 3.6
   angehoben werden. Sollten die Features nur in Plugins genutzt werden, so können nur solche Plugins nicht genutzt
   werden, wenn eine ältere Python Version als 3.6 eingesetzt wird.


Bugfixes im CORE
----------------

* lib.scheduler: fixes part of issue 335
* tools.plugin_metadata_checker: Bug fixes
* lib.module: Bugfix
* lib.item: Bugfix - setting an <item>.property.value didn't trigger further actions
* lib.plugin: Removed call to deprecated Python function
* lib.module: Removed call to deprecated Python function
* lib.translation: Bugfix
* lib.config: Keeping item order when merging structs; improved error handling when referencing non existing structs


Updates im CORE
---------------

* Implemented command line option to create backups of the configuration of SmartHomeNG and to restore from such a backup
* .cer and .key files from /etc are backed up too
* Support for national and regional holidays added
* Support for custom holidays added
* Added a lot of functions to lib.shtime to simplify date and time handling in logics and plugins
* Global translation support (lib.translation) added (moved from plugins to a global level)
* crontab: Implemtation of day ranges
* MQTT Support for logics added (using new mqtt module)
* New class MqttPlugin to support MQTT usage in plugins (using new mqtt module)
* Implemented installation of needed Python packages
* env.system.start now a datetime instead of formatted string
* plugin webinterface showed tabs also if only one tab was defined
* Implemented nesting of structs
* structs allow merging of lists in attributes

* Items:

  * Support for dynamic properties. Right now, values of plugin-specific attributes are implemented as r/o properties


* Logiken:

  * Support für MQTT implementiert

* lib.config: Ignoring files starting with a '.' that are created when accessing a folder from MacOS
* lib.config: Bugfix in merge() if itemtree contains pseudo-nodes (nodes without leafs or subnodes)
* lib.logic: Adjusted log level for triggered logics that are disabled

* Module:

  * http:

    * Webinterfaces: Initial version with support for periodic updata of data
    * Updated datepicker to 1.9.0
    * Added chartjs library for web interfaces
    * Check if ports are already in use implemented

  * admin:

    * Implemented system configuration for holidays and MQTT module
    * Implemented gui_type: wide_str for system configuration and plugin parameters
    * Added multiline support for descriptions (system & plugin configuration)
    * Implemented implemented restore of config backups
    * Additions to system: IPv6 and process ID
    * Items: Display of eval and crontab details corrected
    * Services: Row 'Node-Red service' is only shown, if service is available
    * Services: YAML syntax checker now resolves structs
    * List of loaded plugins: Added button which opens list of relevant blog articles

  * mqtt:

    * New module to delived mqtt support for plugins and logics

* Plugins:

  * Konfigurations-Parameter **class_name** und **class_path** in **/etc/plugin.yaml** sind nun DEPRECATED
  * Support für MQTT implementiert
  * Webinterfaces: make all tabs sticky on webinterface for better scroll appearance



Neue Plugins
------------

Für Details zu den inhaltlichen Änderungen der einzelnen Plugins, bitte die Dokumentation des jeweiligen Plugins konsultieren.


* bose_soundtouch: Plugin zur Integration von Bose Soundtouch Systemen
* executor: Ausführen von Python Statements im Kontext von SmartHomeNG. Alternative für den Interactive Mode von SmartHomeNG
* garminconnect: Ermöglicht den Abruf von Daten (Statistiken, Pulswerte) aus Garmin Connect
* helios_tcp: Erlaubt die Kommunikation über TCP mit Helios KWL Geräten mit Helios Easy Controls
* ksemmodbus: Anbindung von einem Kostal Smart Energy Meter über Modbus
* neato: Plugin zur Anbindung von einem Neato/Vorwerk Staubsauger Robotor an SmartHomeNG
* rpi1wire: Plugin für den Rapberry Pi. Erlaubt den einfachen Zugriff auf 1-Wire Sensoren. Getestet mit Raspberry Pi B und dem Temperatursensor DS18B20
* shelly: Steuerung von Shelly devices über mqtt (nutzt das neue mqtt Modul)
* snmp: SNMP Queries
* vacations: Ermöglicht den Abruf deutscher Schulferien für die Bundesländer BW, BY, BE, BB, HB, HH, HE, MV, NI, NW, RP, SL, SN, ST, SH, TH.
* xioami_vac: Zugriff auf Xiaomi Saugroboter
* yamahayxc: Plugin, um Yamaha MusicCast-Geräte zu kontrollieren



Plugin Updates
--------------

* alexa4p3:

  * fixed naming for plugin
  * Added plugin name as source when setting item values

* avdevice:

  * fixes in plugin.yaml

* avm:

  * added write support for AVM Dec 301 hkrt devices (command set temperature)
  * Now using one single item for read and write temperature setpoint; fixed filter for items calls by avm plugin
  * changed name of monitoring service thread
  * fix for retrieval of HOST data and MultiInstance functionality
  * bugfixes for MI handling
  * fixed bug in default value for ssl port

* blockly:

  * updated blockly to Release Q3 Patch 4

* darksky:

  * added hourly and daily data to struct
  * fix for multiple items accessing the same match string
  * Quick Fix Webinterface Item, needs more work though
  * added support for multiple items in a key
  * compact table appearance, show large text block reduced at first

* Dashbutton:

  * updated from buggy kamene package to scapy package

* dmx:

  * converted to SmartPlugin

* gpio:

  * fix problem with slow raspis after reboot

* ical:

  * Fix for recurring event having multiple exceptions
  * fix problems with long lines that are continued on next line
  * Fix for recurring event having multiple exceptions

* kathrein:

  * converted to SmartPlugin

* knx:

  * added hostname support

* mailrcv:

  * Added option to set the name of the trashfolder to use
  * Removed use of smarthome object and used self.scheduler_add instead

* memlog:

  * improved documentation

* milight:

  * converted to SmartPlugin
  * implemented multi-instance

* miflora:

  * Fixed some namings: scheduler methods of SmartPlugin
  * Fixed new init parameter access
  * added Web Interface with auto update
  * added support for all 3 Libraries used in Miflora pypi package
  * new default library: bluepy (which needs a new package to be installed)
  * only instantiate MifloraPoller once

* mqtt:

  * renamed existing mqtt plugin to mqtt1 and set deprecated flag for this plugin
  * reimplemented mqtt plugin derived from class MqttPlugin for using the new mqtt module
  * added item attribute **bool_values**: defines which mqtt payload values should be interpreted as True or False
  * added gui_type: wide_str for appropriate parameters

* nuki:

  * Added updates for event values in web interface via Ajax

* odlinfo:

  * small fixes

* onewire:

  * Fixed error handling in case of readout problem (85 °C)
  * plugin enable use of alias names
  * added webinterface
  * reworked internals
  * fix multiple thread creation after discovery
  * fix bug with too many threads started
  * plugin fixed bug with alias adressing

* rcswitch:

  * rcswitch_host - change type to ip

* roomba:

  * converted to SmartPlugin

* rrd:

  * converted to SmartPlugin

* rtr:

  * bugfix in stop_controller()
  * fixed stop_item handling
  * Added check of self.alive before accessing items

* russound

  * converted to SmartPlugin
  * handling of decode error added

* sma_em:

  * Added updates for values in web interface via Ajax
  * SMA_EM: reworked whole plugin as requested in issue #319

    * supports multicasts of new versions of energy meter
    * item naming changed (look at newly introduced struct or README)
    * new items for info if consume and supply is active
    * introduced scheduler instead of sleeping thread (needed to show that a plugin updated the item, also better for performance)

* smlx:

  * Added parameters for CRC check
  * implement support for Holley DTZ541 (2018 model with faulty CRC implementation)
  * fixes actualTime calculation issue and provides status properties
  * Fixed issue with calculation of actualTime.
  * Fixed misinterpretation of Client-ID as OBIS code.
  * Added properties for Smartmeter status

* solarlog:

  * converted to SmartPlugin
  * bugfixes

* speech:

  * converted to SmartPlugin

* squeezebox:

  * fix repeat and shuffle playlist
  * various bugfixes
  * some optimizations
  * updates play,pause,stop items every time there is a change

* stateengine:

  * improved Stateeninge Graph in Web Interface
  * documentation updates
  * various bugfixes
  * fix immediate action run after leaving state
  * fix problem running leave actions
  * improve collision handling when running multiple evals at the same time

* telegram:

  * documentation updates
  * pretify thread names for job queue
  * Removed error message when welcome_msg or bye_msg is empty

* thz:

  * added a missing method

* trovis557x:

  * Corrected processing of negative 16-bit register values, also corrected some typos

* uzsu:

  * added error message when using wrong sv widget
  * various bugfixes
  * add lastvalue and standard parameters config for interpolation

* visu_websocket:

  * Improved exception handling


Veraltete Plugins
-----------------

Die folgenden Plugins wurden bereits in v1.6 als *deprecated* (veraltet) gekennzeichnet. Dieses Kennzeichen bedeutet,
dass die Plugins zwar noch funktionieren, aber nicht mehr weiterentwickelt werden und aus dem kommenden Release von
SmartHomeNG entfernt werden. Nutzer dieser Plugins sollten auf entsprechende Nachfolge-Plugins umstellen.

* System Plugins

  * sqlite - auf das **database** Plugin umstellen
  * sqlite_visu2_8 - auf das **database** Plugin umstellen

* Gateway Plugins

  * tellstick - classic Plugin, laut Umfrage nicht genutzt

* Interface Plugins

  * netio230b - classic Plugin, laut Umfrage nicht genutzt
  * smawb - classic Plugin, laut Umfrage nicht genutzt

* Web Plugins

  * alexa - auf das **alexa4p3** Plugin umstellen
  * boxcar - classic Plugin, laut Umfrage nicht genutzt
  * mail - auf die Plugins **mailsend** bzw. **mailrcv** umstellen
  * openenergymonitor - classic Plugin, laut Umfrage nicht genutzt
  * wunderground - das freie API wird durch Wunderground nicht mehr zur Verfügung gestellt


folgende weitere Plugins werden mit SmartHomeNG v1.7 als *deprecated* (veraltet) gekennzeichnet, da sich keine Nutzer
bzw. Tester gefunden haben:

* Gateway Plugins

  * ecmd
  * elro
  * iaqstick
  * snom
  * tellstick

* Interface Plugins

  * easymeter
  * netio230b
  * smawb
  * vr100

* Web Plugins

  * boxcar
  * nma

Außerdem wurde das bisherige mqtt Plugin umbenannt in mqtt1 und als *deprecated* (veraltet) gekennzeichnet, da das
neue mqtt Plugin die Funktionalität übernimmt und auf dem mqtt Modul des aktuellen Cores aufsetzt.


Dokumentation
-------------

* Anwender Dokumentation

  * sample_module zu /dev hinzugefügt
  * Neue MQTT Untersützung dokumentiert
  * Allgemeine Updates und Erweiterungen
  * Komplettanleitung überarbeitet
  * Overview Graphik überarbeitet
  * Arbeiten mit Funktionen in Logiken ergänzt
  * Abschnitt Beispiele, Tipps & Tricks hinzugefügt (Dank an sisamiwe für die Beispiele)


* Entwickler Dokumentation

  * Dokumentation zur Erstellung von Webinterfaces für Plugins erweitert
  * Neue MQTT Untersützung dokumentiert
  * Allgemeine Updates und Erweiterungen
